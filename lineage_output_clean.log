ExecutionPlan (apiVersion: 1.2):
{"id":"58edc9b2-85ac-55bf-8465-7029c398de3d","name":"Spline Lineage Test","operations":{"write":{"outputSource":"file:/home/puppyseal/Documents/code/output/spline_analytics","append":false,"id":"op-0","name":"InsertIntoHadoopFsRelationCommand","childIds":["op-1"],"params":{"path":"./output/spline_analytics"},"extra":{"destinationType":"parquet"}},"other":[{"id":"op-11","name":"ParallelCollectionRDD"},{"id":"op-17","name":"ParallelCollectionRDD"},{"id":"op-10","name":"PythonRDD","childIds":["op-11"]},{"id":"op-16","name":"PythonRDD","childIds":["op-17"]},{"id":"op-15","name":"MapPartitionsRDD","childIds":["op-16"]},{"id":"op-9","name":"MapPartitionsRDD","childIds":["op-10"]},{"id":"op-14","name":"MapPartitionsRDD","childIds":["op-15"]},{"id":"op-8","name":"MapPartitionsRDD","childIds":["op-9"]},{"id":"op-13","name":"MapPartitionsRDD","childIds":["op-14"]},{"id":"op-7","name":"MapPartitionsRDD","childIds":["op-8"]},{"id":"op-12","name":"LogicalRDD","childIds":["op-13"],"output":["attr-0","attr-1","attr-2"],"params":{"rdd":"MapPartitionsRDD[9] at applySchemaToPythonRDD at NativeMethodAccessorImpl.java:0","isStreaming":false,"outputOrdering":null,"outputPartitioning":"UnknownPartitioning(0)"}},{"id":"op-6","name":"LogicalRDD","childIds":["op-7"],"output":["attr-3","attr-4","attr-5","attr-6","attr-7"],"params":{"rdd":"MapPartitionsRDD[4] at applySchemaToPythonRDD at NativeMethodAccessorImpl.java:0","isStreaming":false,"outputOrdering":null,"outputPartitioning":"UnknownPartitioning(0)"}},{"id":"op-5","name":"Join","childIds":["op-6","op-12"],"output":["attr-3","attr-4","attr-5","attr-6","attr-7","attr-0","attr-1","attr-2"],"params":{"condition":{"__exprId":"expr-0"},"hint":"","joinType":"INNER"}},{"id":"op-4","name":"Project","childIds":["op-5"],"output":["attr-3","attr-4","attr-5","attr-6","attr-7","attr-1","attr-2"],"params":{"projectList":[{"__attrId":"attr-3"},{"__attrId":"attr-4"},{"__attrId":"attr-5"},{"__attrId":"attr-6"},{"__attrId":"attr-7"},{"__attrId":"attr-1"},{"__attrId":"attr-2"}]}},{"id":"op-3","name":"Project","childIds":["op-4"],"output":["attr-3","attr-4","attr-5","attr-6","attr-7","attr-1","attr-2","attr-8"],"params":{"projectList":[{"__attrId":"attr-3"},{"__attrId":"attr-4"},{"__attrId":"attr-5"},{"__attrId":"attr-6"},{"__attrId":"attr-7"},{"__attrId":"attr-1"},{"__attrId":"attr-2"},{"__exprId":"expr-1"}]}},{"id":"op-2","name":"Aggregate","childIds":["op-3"],"output":["attr-4","attr-2","attr-9","attr-10","attr-11"],"params":{"groupingExpressions":[{"__attrId":"attr-4"},{"__attrId":"attr-2"}],"aggregateExpressions":[{"__attrId":"attr-4"},{"__attrId":"attr-2"},{"__exprId":"expr-8"},{"__exprId":"expr-11"},{"__exprId":"expr-14"}]}},{"id":"op-1","name":"Sort","childIds":["op-2"],"output":["attr-4","attr-2","attr-9","attr-10","attr-11"],"params":{"order":[{"expression":{"__attrId":"attr-4"},"direction":"ASC","nullOrdering":"NULLS FIRST"},{"expression":{"__attrId":"attr-2"},"direction":"ASC","nullOrdering":"NULLS FIRST"}],"global":true}}]},"attributes":[{"id":"attr-0","dataType":"e63adadc-648a-56a0-9424-3289858cf0bb","name":"order_id"},{"id":"attr-1","dataType":"75fe27b9-9a00-5c7d-966f-33ba32333133","name":"customer_name"},{"id":"attr-2","dataType":"75fe27b9-9a00-5c7d-966f-33ba32333133","name":"tier"},{"id":"attr-3","dataType":"e63adadc-648a-56a0-9424-3289858cf0bb","name":"order_id"},{"id":"attr-4","dataType":"75fe27b9-9a00-5c7d-966f-33ba32333133","name":"product"},{"id":"attr-5","dataType":"e63adadc-648a-56a0-9424-3289858cf0bb","name":"amount"},{"id":"attr-6","dataType":"e63adadc-648a-56a0-9424-3289858cf0bb","name":"quantity"},{"id":"attr-7","dataType":"75fe27b9-9a00-5c7d-966f-33ba32333133","name":"order_date"},{"id":"attr-8","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__exprId":"expr-1"}],"name":"discounted_amount"},{"id":"attr-9","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__exprId":"expr-8"}],"name":"tier_revenue"},{"id":"attr-10","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__exprId":"expr-11"}],"name":"avg_tier_revenue"},{"id":"attr-11","dataType":"e63adadc-648a-56a0-9424-3289858cf0bb","childRefs":[{"__exprId":"expr-14"}],"name":"tier_quantity"}],"expressions":{"functions":[{"id":"expr-0","dataType":"a155e715-56ab-59c4-a94b-ed1851a6984a","childRefs":[{"__attrId":"attr-3"},{"__attrId":"attr-0"}],"extra":{"simpleClassName":"EqualTo","_typeHint":"expr.Binary","symbol":"="},"name":"equalto"},{"id":"expr-3","dataType":"a155e715-56ab-59c4-a94b-ed1851a6984a","childRefs":[{"__attrId":"attr-2"},{"__exprId":"expr-4"}],"extra":{"simpleClassName":"EqualTo","_typeHint":"expr.Binary","symbol":"="},"name":"equalto"},{"id":"expr-6","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__attrId":"attr-5"}],"extra":{"simpleClassName":"Cast","_typeHint":"expr.Generic"},"name":"cast","params":{"timeZoneId":"Asia/Kolkata","evalMode":"LEGACY"}},{"id":"expr-5","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__exprId":"expr-6"},{"__exprId":"expr-7"}],"extra":{"simpleClassName":"Multiply","_typeHint":"expr.Binary","symbol":"*"},"name":"multiply","params":{"evalMode":"LEGACY"}},{"id":"expr-2","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__exprId":"expr-3"},{"__exprId":"expr-5"},{"__exprId":"expr-6"}],"extra":{"simpleClassName":"CaseWhen","_typeHint":"expr.Generic"},"name":"casewhen","params":{"branches":["((tier#12 = Premium),(cast(amount#2L as double) * 0.9))"],"elseValue":"cast(amount#2L as double)"}},{"id":"expr-1","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__exprId":"expr-2"}],"extra":{"simpleClassName":"Alias","_typeHint":"expr.Alias"},"name":"discounted_amount","params":{"name":"discounted_amount","nonInheritableMetadataKeys":["__dataset_id","__col_position"]}},{"id":"expr-10","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__attrId":"attr-8"}],"extra":{"simpleClassName":"aggregate.Sum","_typeHint":"expr.Generic"},"name":"sum","params":{"evalMode":"LEGACY"}},{"id":"expr-9","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__exprId":"expr-10"}],"extra":{"simpleClassName":"aggregate.AggregateExpression","_typeHint":"expr.Generic"},"name":"aggregateexpression","params":{"isDistinct":false,"mode":"Complete"}},{"id":"expr-8","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__exprId":"expr-9"}],"extra":{"simpleClassName":"Alias","_typeHint":"expr.Alias"},"name":"tier_revenue","params":{"name":"tier_revenue","nonInheritableMetadataKeys":["__dataset_id","__col_position"]}},{"id":"expr-13","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__attrId":"attr-8"}],"extra":{"simpleClassName":"aggregate.Average","_typeHint":"expr.Generic"},"name":"avg","params":{"evalMode":"LEGACY"}},{"id":"expr-12","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__exprId":"expr-13"}],"extra":{"simpleClassName":"aggregate.AggregateExpression","_typeHint":"expr.Generic"},"name":"aggregateexpression","params":{"isDistinct":false,"mode":"Complete"}},{"id":"expr-11","dataType":"ab4da308-91fb-550a-a5e4-beddecff2a2b","childRefs":[{"__exprId":"expr-12"}],"extra":{"simpleClassName":"Alias","_typeHint":"expr.Alias"},"name":"avg_tier_revenue","params":{"name":"avg_tier_revenue","nonInheritableMetadataKeys":["__dataset_id","__col_position"]}},{"id":"expr-16","dataType":"e63adadc-648a-56a0-9424-3289858cf0bb","childRefs":[{"__attrId":"attr-6"}],"extra":{"simpleClassName":"aggregate.Sum","_typeHint":"expr.Generic"},"name":"sum","params":{"evalMode":"LEGACY"}},{"id":"expr-15","dataType":"e63adadc-648a-56a0-9424-3289858cf0bb","childRefs":[{"__exprId":"expr-16"}],"extra":{"simpleClassName":"aggregate.AggregateExpression","_typeHint":"expr.Generic"},"name":"aggregateexpression","params":{"isDistinct":false,"mode":"Complete"}},{"id":"expr-14","dataType":"e63adadc-648a-56a0-9424-3289858cf0bb","childRefs":[{"__exprId":"expr-15"}],"extra":{"simpleClassName":"Alias","_typeHint":"expr.Alias"},"name":"tier_quantity","params":{"name":"tier_quantity","nonInheritableMetadataKeys":["__dataset_id","__col_position"]}}],"constants":[{"id":"expr-4","dataType":"455d9d5b-7620-529e-840b-897cee45e560","extra":{"simpleClassName":"Literal","_typeHint":"expr.Literal"},"value":"Premium"},{"id":"expr-7","dataType":"ba7ef708-332f-54fd-a671-c91d13ae6f8e","extra":{"simpleClassName":"Literal","_typeHint":"expr.Literal"},"value":0.9}]},"systemInfo":{"name":"spark","version":"3.5.0"},"agentInfo":{"name":"spline","version":"2.2.3"},"extraInfo":{"appName":"Spline Lineage Test","dataTypes":[{"id":"e63adadc-648a-56a0-9424-3289858cf0bb","name":"bigint","nullable":true,"_typeHint":"dt.Simple"},{"id":"75fe27b9-9a00-5c7d-966f-33ba32333133","name":"string","nullable":true,"_typeHint":"dt.Simple"},{"id":"a155e715-56ab-59c4-a94b-ed1851a6984a","name":"boolean","nullable":true,"_typeHint":"dt.Simple"},{"id":"ab4da308-91fb-550a-a5e4-beddecff2a2b","name":"double","nullable":true,"_typeHint":"dt.Simple"},{"id":"455d9d5b-7620-529e-840b-897cee45e560","name":"string","nullable":false,"_typeHint":"dt.Simple"},{"id":"ba7ef708-332f-54fd-a671-c91d13ae6f8e","name":"double","nullable":false,"_typeHint":"dt.Simple"}]}}
ExecutionEvent (apiVersion: 1.2):
{"planId":"58edc9b2-85ac-55bf-8465-7029c398de3d","timestamp":1756723398777,"durationNs":830491808,"extra":{"appId":"local-1756723390449","user":"puppyseal","readMetrics":{},"writeMetrics":{}}}
